var cov_154w8ic28m=function(){var path="/Users/tormodflesjo/tormodWork/testchess/bot-o-tron/src/utils/ChessUtils.js",hash="cc0fed20a8dea87cf58e18302c16d9f3630fa474",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/Users/tormodflesjo/tormodWork/testchess/bot-o-tron/src/utils/ChessUtils.js",statementMap:{"0":{start:{line:1,column:14},end:{line:1,column:39}},"1":{start:{line:10,column:4},end:{line:10,column:32}},"2":{start:{line:14,column:4},end:{line:14,column:23}},"3":{start:{line:18,column:4},end:{line:18,column:67}},"4":{start:{line:18,column:26},end:{line:18,column:65}},"5":{start:{line:25,column:4},end:{line:25,column:72}},"6":{start:{line:32,column:4},end:{line:32,column:47}},"7":{start:{line:36,column:4},end:{line:36,column:28}},"8":{start:{line:40,column:4},end:{line:40,column:26}},"9":{start:{line:44,column:4},end:{line:44,column:22}},"10":{start:{line:48,column:4},end:{line:48,column:29}},"11":{start:{line:52,column:4},end:{line:55,column:7}},"12":{start:{line:53,column:16},end:{line:53,column:38}},"13":{start:{line:54,column:6},end:{line:54,column:37}},"14":{start:{line:59,column:4},end:{line:59,column:55}},"15":{start:{line:63,column:4},end:{line:63,column:73}},"16":{start:{line:67,column:4},end:{line:67,column:106}},"17":{start:{line:67,column:49},end:{line:67,column:104}},"18":{start:{line:71,column:4},end:{line:71,column:98}},"19":{start:{line:75,column:4},end:{line:75,column:62}},"20":{start:{line:79,column:4},end:{line:79,column:53}},"21":{start:{line:83,column:16},end:{line:83,column:25}},"22":{start:{line:84,column:16},end:{line:84,column:25}},"23":{start:{line:85,column:4},end:{line:85,column:40}},"24":{start:{line:89,column:4},end:{line:89,column:38}},"25":{start:{line:93,column:4},end:{line:93,column:69}},"26":{start:{line:97,column:18},end:{line:97,column:63}},"27":{start:{line:97,column:44},end:{line:97,column:62}},"28":{start:{line:98,column:4},end:{line:98,column:81}},"29":{start:{line:98,column:60},end:{line:98,column:79}},"30":{start:{line:102,column:4},end:{line:102,column:37}},"31":{start:{line:106,column:4},end:{line:106,column:37}},"32":{start:{line:110,column:4},end:{line:110,column:51}},"33":{start:{line:114,column:20},end:{line:114,column:58}},"34":{start:{line:115,column:4},end:{line:115,column:110}},"35":{start:{line:115,column:48},end:{line:115,column:84}},"36":{start:{line:115,column:103},end:{line:115,column:108}},"37":{start:{line:119,column:0},end:{line:119,column:28}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:9,column:2},end:{line:9,column:3}},loc:{start:{line:9,column:80},end:{line:11,column:3}},line:9},"1":{name:"(anonymous_1)",decl:{start:{line:13,column:2},end:{line:13,column:3}},loc:{start:{line:13,column:10},end:{line:15,column:3}},line:13},"2":{name:"(anonymous_2)",decl:{start:{line:17,column:2},end:{line:17,column:3}},loc:{start:{line:17,column:20},end:{line:19,column:3}},line:17},"3":{name:"(anonymous_3)",decl:{start:{line:18,column:18},end:{line:18,column:19}},loc:{start:{line:18,column:26},end:{line:18,column:65}},line:18},"4":{name:"(anonymous_4)",decl:{start:{line:24,column:2},end:{line:24,column:3}},loc:{start:{line:24,column:12},end:{line:26,column:3}},line:24},"5":{name:"(anonymous_5)",decl:{start:{line:31,column:2},end:{line:31,column:3}},loc:{start:{line:31,column:15},end:{line:33,column:3}},line:31},"6":{name:"(anonymous_6)",decl:{start:{line:35,column:2},end:{line:35,column:3}},loc:{start:{line:35,column:8},end:{line:37,column:3}},line:35},"7":{name:"(anonymous_7)",decl:{start:{line:39,column:2},end:{line:39,column:3}},loc:{start:{line:39,column:13},end:{line:41,column:3}},line:39},"8":{name:"(anonymous_8)",decl:{start:{line:43,column:2},end:{line:43,column:3}},loc:{start:{line:43,column:9},end:{line:45,column:3}},line:43},"9":{name:"(anonymous_9)",decl:{start:{line:47,column:2},end:{line:47,column:3}},loc:{start:{line:47,column:9},end:{line:49,column:3}},line:47},"10":{name:"(anonymous_10)",decl:{start:{line:51,column:2},end:{line:51,column:3}},loc:{start:{line:51,column:20},end:{line:56,column:3}},line:51},"11":{name:"(anonymous_11)",decl:{start:{line:52,column:37},end:{line:52,column:38}},loc:{start:{line:52,column:47},end:{line:55,column:5}},line:52},"12":{name:"(anonymous_12)",decl:{start:{line:58,column:2},end:{line:58,column:3}},loc:{start:{line:58,column:17},end:{line:60,column:3}},line:58},"13":{name:"(anonymous_13)",decl:{start:{line:62,column:2},end:{line:62,column:3}},loc:{start:{line:62,column:26},end:{line:64,column:3}},line:62},"14":{name:"(anonymous_14)",decl:{start:{line:66,column:2},end:{line:66,column:3}},loc:{start:{line:66,column:36},end:{line:68,column:3}},line:66},"15":{name:"(anonymous_15)",decl:{start:{line:67,column:39},end:{line:67,column:40}},loc:{start:{line:67,column:49},end:{line:67,column:104}},line:67},"16":{name:"(anonymous_16)",decl:{start:{line:70,column:2},end:{line:70,column:3}},loc:{start:{line:70,column:22},end:{line:72,column:3}},line:70},"17":{name:"(anonymous_17)",decl:{start:{line:74,column:2},end:{line:74,column:3}},loc:{start:{line:74,column:17},end:{line:76,column:3}},line:74},"18":{name:"(anonymous_18)",decl:{start:{line:78,column:2},end:{line:78,column:3}},loc:{start:{line:78,column:26},end:{line:80,column:3}},line:78},"19":{name:"(anonymous_19)",decl:{start:{line:82,column:2},end:{line:82,column:3}},loc:{start:{line:82,column:26},end:{line:86,column:3}},line:82},"20":{name:"(anonymous_20)",decl:{start:{line:88,column:2},end:{line:88,column:3}},loc:{start:{line:88,column:22},end:{line:90,column:3}},line:88},"21":{name:"(anonymous_21)",decl:{start:{line:92,column:2},end:{line:92,column:3}},loc:{start:{line:92,column:24},end:{line:94,column:3}},line:92},"22":{name:"(anonymous_22)",decl:{start:{line:96,column:2},end:{line:96,column:3}},loc:{start:{line:96,column:28},end:{line:99,column:3}},line:96},"23":{name:"(anonymous_23)",decl:{start:{line:97,column:36},end:{line:97,column:37}},loc:{start:{line:97,column:44},end:{line:97,column:62}},line:97},"24":{name:"(anonymous_24)",decl:{start:{line:98,column:52},end:{line:98,column:53}},loc:{start:{line:98,column:60},end:{line:98,column:79}},line:98},"25":{name:"(anonymous_25)",decl:{start:{line:101,column:2},end:{line:101,column:3}},loc:{start:{line:101,column:16},end:{line:103,column:3}},line:101},"26":{name:"(anonymous_26)",decl:{start:{line:105,column:2},end:{line:105,column:3}},loc:{start:{line:105,column:16},end:{line:107,column:3}},line:105},"27":{name:"(anonymous_27)",decl:{start:{line:109,column:2},end:{line:109,column:3}},loc:{start:{line:109,column:17},end:{line:111,column:3}},line:109},"28":{name:"(anonymous_28)",decl:{start:{line:113,column:2},end:{line:113,column:3}},loc:{start:{line:113,column:19},end:{line:116,column:3}},line:113},"29":{name:"(anonymous_29)",decl:{start:{line:115,column:38},end:{line:115,column:39}},loc:{start:{line:115,column:48},end:{line:115,column:84}},line:115},"30":{name:"(anonymous_30)",decl:{start:{line:115,column:93},end:{line:115,column:94}},loc:{start:{line:115,column:103},end:{line:115,column:108}},line:115}},branchMap:{"0":{loc:{start:{line:9,column:14},end:{line:9,column:78}},type:"default-arg",locations:[{start:{line:9,column:20},end:{line:9,column:78}}],line:9},"1":{loc:{start:{line:25,column:34},end:{line:25,column:70}},type:"cond-expr",locations:[{start:{line:25,column:55},end:{line:25,column:65}},{start:{line:25,column:68},end:{line:25,column:70}}],line:25},"2":{loc:{start:{line:54,column:13},end:{line:54,column:36}},type:"binary-expr",locations:[{start:{line:54,column:13},end:{line:54,column:14}},{start:{line:54,column:18},end:{line:54,column:36}}],line:54},"3":{loc:{start:{line:89,column:11},end:{line:89,column:37}},type:"cond-expr",locations:[{start:{line:89,column:28},end:{line:89,column:31}},{start:{line:89,column:34},end:{line:89,column:37}}],line:89},"4":{loc:{start:{line:98,column:11},end:{line:98,column:80}},type:"cond-expr",locations:[{start:{line:98,column:26},end:{line:98,column:31}},{start:{line:98,column:34},end:{line:98,column:80}}],line:98}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0},b:{"0":[0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},_coverageSchema:"d34fc3e6b8297bcde183f5492bcb8fcb36775295"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();const Chess=(cov_154w8ic28m.s[0]++,require("chess.js").Chess);/**
 * Wraps chess.js with useful extras.
 */class ChessUtils{constructor(fen=(cov_154w8ic28m.b[0][0]++,"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1")){cov_154w8ic28m.f[0]++;cov_154w8ic28m.s[1]++;this.chess=new Chess(fen);}reset(){cov_154w8ic28m.f[1]++;cov_154w8ic28m.s[2]++;this.chess.reset();}applyMoves(moves){cov_154w8ic28m.f[2]++;cov_154w8ic28m.s[3]++;moves.forEach(move=>{cov_154w8ic28m.f[3]++;cov_154w8ic28m.s[4]++;return this.chess.move(move,{sloppy:true});});}/**
   * Convert a chess.js move to a uci move
   */uci(move){cov_154w8ic28m.f[4]++;cov_154w8ic28m.s[5]++;return move.from+move.to+(move.flags==="p"?(cov_154w8ic28m.b[1][0]++,move.piece):(cov_154w8ic28m.b[1][1]++,""));}/**
   * Legal moves from current position.
   */legalMoves(){cov_154w8ic28m.f[5]++;cov_154w8ic28m.s[6]++;return this.chess.moves({verbose:true});}fen(){cov_154w8ic28m.f[6]++;cov_154w8ic28m.s[7]++;return this.chess.fen();}move(move){cov_154w8ic28m.f[7]++;cov_154w8ic28m.s[8]++;this.chess.move(move);}undo(){cov_154w8ic28m.f[8]++;cov_154w8ic28m.s[9]++;this.chess.undo();}turn(){cov_154w8ic28m.f[9]++;cov_154w8ic28m.s[10]++;return this.chess.turn();}squaresOf(colour){cov_154w8ic28m.f[10]++;cov_154w8ic28m.s[11]++;return this.chess.SQUARES.filter(square=>{cov_154w8ic28m.f[11]++;const r=(cov_154w8ic28m.s[12]++,this.chess.get(square));cov_154w8ic28m.s[13]++;return(cov_154w8ic28m.b[2][0]++,r)&&(cov_154w8ic28m.b[2][1]++,r.color===colour);});}squareOfKing(){cov_154w8ic28m.f[12]++;cov_154w8ic28m.s[14]++;return this.squaresOfPiece(this.chess.turn(),"k");}squareOfOpponentsKing(){cov_154w8ic28m.f[13]++;cov_154w8ic28m.s[15]++;return this.squaresOfPiece(this.otherPlayer(this.chess.turn()),"k");}squaresOfPiece(colour,pieceType){cov_154w8ic28m.f[14]++;cov_154w8ic28m.s[16]++;return this.squaresOf(colour).find(square=>{cov_154w8ic28m.f[15]++;cov_154w8ic28m.s[17]++;return this.chess.get(square).type.toLowerCase()===pieceType;});}coordinates(square){cov_154w8ic28m.f[16]++;cov_154w8ic28m.s[18]++;return{x:square.charCodeAt(0)-"a".charCodeAt(0)+1,y:Number(square.substring(1,2))};}distance(a,b){cov_154w8ic28m.f[17]++;cov_154w8ic28m.s[19]++;return Math.max(Math.abs(a.x-b.x),Math.abs(a.y-b.y));}manhattanDistance(a,b){cov_154w8ic28m.f[18]++;cov_154w8ic28m.s[20]++;return Math.abs(a.x-b.x)+Math.abs(a.y-b.y);}euclideanDistance(a,b){cov_154w8ic28m.f[19]++;const dx=(cov_154w8ic28m.s[21]++,a.x-b.x);const dy=(cov_154w8ic28m.s[22]++,a.y-b.y);cov_154w8ic28m.s[23]++;return Math.sqrt(dx*dx+dy*dy);}otherPlayer(colour){cov_154w8ic28m.f[20]++;cov_154w8ic28m.s[24]++;return colour==="w"?(cov_154w8ic28m.b[3][0]++,"b"):(cov_154w8ic28m.b[3][1]++,"w");}pickRandomMove(moves){cov_154w8ic28m.f[21]++;cov_154w8ic28m.s[25]++;return this.uci(moves[Math.floor(Math.random()*moves.length)]);}filterForcing(legalMoves){cov_154w8ic28m.f[22]++;const mates=(cov_154w8ic28m.s[26]++,legalMoves.filter(move=>{cov_154w8ic28m.f[23]++;cov_154w8ic28m.s[27]++;return /#/.test(move.san);}));cov_154w8ic28m.s[28]++;return mates.length?(cov_154w8ic28m.b[4][0]++,mates):(cov_154w8ic28m.b[4][1]++,legalMoves.filter(move=>{cov_154w8ic28m.f[24]++;cov_154w8ic28m.s[29]++;return /\+/.test(move.san);}));}inCheckmate(){cov_154w8ic28m.f[25]++;cov_154w8ic28m.s[30]++;return this.chess.in_checkmate();}inStalemate(){cov_154w8ic28m.f[26]++;cov_154w8ic28m.s[31]++;return this.chess.in_stalemate();}materialEval(){cov_154w8ic28m.f[27]++;cov_154w8ic28m.s[32]++;return this.material("w")-this.material("b");}material(colour){cov_154w8ic28m.f[28]++;const valueOf=(cov_154w8ic28m.s[33]++,{p:1,n:3,b:3,r:6,q:9,k:0});cov_154w8ic28m.s[34]++;return this.squaresOf(colour).map(square=>{cov_154w8ic28m.f[29]++;cov_154w8ic28m.s[35]++;return valueOf[this.chess.get(square).type];}).reduce((a,b)=>{cov_154w8ic28m.f[30]++;cov_154w8ic28m.s[36]++;return a+b;});}}cov_154w8ic28m.s[37]++;module.exports=ChessUtils;