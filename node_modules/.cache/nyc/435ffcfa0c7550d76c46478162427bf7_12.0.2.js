var cov_1zzp1mzpgs=function(){var path="/Users/tormodflesjo/tormodWork/testchess/bot-o-tron/src/RobotUser.js",hash="0cd68a0f865ddfdcff0677195750796c2a6a6921",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/Users/tormodflesjo/tormodWork/testchess/bot-o-tron/src/RobotUser.js",statementMap:{"0":{start:{line:1,column:19},end:{line:1,column:42}},"1":{start:{line:2,column:13},end:{line:2,column:30}},"2":{start:{line:13,column:4},end:{line:13,column:19}},"3":{start:{line:14,column:4},end:{line:14,column:25}},"4":{start:{line:18,column:4},end:{line:18,column:48}},"5":{start:{line:19,column:4},end:{line:19,column:60}},"6":{start:{line:20,column:4},end:{line:20,column:61}},"7":{start:{line:20,column:35},end:{line:20,column:59}},"8":{start:{line:21,column:4},end:{line:21,column:24}},"9":{start:{line:25,column:4},end:{line:34,column:5}},"10":{start:{line:27,column:8},end:{line:27,column:46}},"11":{start:{line:28,column:8},end:{line:28,column:14}},"12":{start:{line:30,column:8},end:{line:30,column:44}},"13":{start:{line:31,column:8},end:{line:31,column:14}},"14":{start:{line:33,column:8},end:{line:33,column:66}},"15":{start:{line:38,column:17},end:{line:38,column:76}},"16":{start:{line:39,column:4},end:{line:39,column:19}},"17":{start:{line:43,column:4},end:{line:53,column:5}},"18":{start:{line:44,column:6},end:{line:44,column:79}},"19":{start:{line:45,column:23},end:{line:45,column:68}},"20":{start:{line:46,column:6},end:{line:46,column:57}},"21":{start:{line:48,column:6},end:{line:50,column:8}},"22":{start:{line:51,column:23},end:{line:51,column:67}},"23":{start:{line:52,column:6},end:{line:52,column:57}},"24":{start:{line:57,column:0},end:{line:57,column:27}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:12,column:2},end:{line:12,column:3}},loc:{start:{line:12,column:27},end:{line:15,column:3}},line:12},"1":{name:"(anonymous_1)",decl:{start:{line:17,column:2},end:{line:17,column:3}},loc:{start:{line:17,column:16},end:{line:22,column:3}},line:17},"2":{name:"(anonymous_2)",decl:{start:{line:20,column:26},end:{line:20,column:27}},loc:{start:{line:20,column:35},end:{line:20,column:59}},line:20},"3":{name:"(anonymous_3)",decl:{start:{line:24,column:2},end:{line:24,column:3}},loc:{start:{line:24,column:22},end:{line:35,column:3}},line:24},"4":{name:"(anonymous_4)",decl:{start:{line:37,column:2},end:{line:37,column:3}},loc:{start:{line:37,column:22},end:{line:40,column:3}},line:37},"5":{name:"(anonymous_5)",decl:{start:{line:42,column:2},end:{line:42,column:3}},loc:{start:{line:42,column:35},end:{line:54,column:3}},line:42}},branchMap:{"0":{loc:{start:{line:25,column:4},end:{line:34,column:5}},type:"switch",locations:[{start:{line:26,column:6},end:{line:28,column:14}},{start:{line:29,column:6},end:{line:31,column:14}},{start:{line:32,column:6},end:{line:33,column:66}}],line:25},"1":{loc:{start:{line:43,column:4},end:{line:53,column:5}},type:"if",locations:[{start:{line:43,column:4},end:{line:53,column:5}},{start:{line:43,column:4},end:{line:53,column:5}}],line:43},"2":{loc:{start:{line:46,column:30},end:{line:46,column:55}},type:"binary-expr",locations:[{start:{line:46,column:30},end:{line:46,column:43}},{start:{line:46,column:47},end:{line:46,column:55}}],line:46},"3":{loc:{start:{line:52,column:30},end:{line:52,column:55}},type:"binary-expr",locations:[{start:{line:52,column:30},end:{line:52,column:43}},{start:{line:52,column:47},end:{line:52,column:55}}],line:52}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},b:{"0":[0,0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"d34fc3e6b8297bcde183f5492bcb8fcb36775295"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();const LichessApi=(cov_1zzp1mzpgs.s[0]++,require("./LichessApi"));const Game=(cov_1zzp1mzpgs.s[1]++,require("./Game"));/**
 * RobotUser listens for challenges and spawns Games on accepting.
 *
 */class RobotUser{/**
   * Initialise with access token to lichess and a player algorithm.
   */constructor(api,player){cov_1zzp1mzpgs.f[0]++;cov_1zzp1mzpgs.s[2]++;this.api=api;cov_1zzp1mzpgs.s[3]++;this.player=player;}async start(){cov_1zzp1mzpgs.f[1]++;cov_1zzp1mzpgs.s[4]++;this.account=await this.api.accountInfo();cov_1zzp1mzpgs.s[5]++;console.log("Playing as "+this.account.data.username);cov_1zzp1mzpgs.s[6]++;this.api.streamEvents(event=>{cov_1zzp1mzpgs.f[2]++;cov_1zzp1mzpgs.s[7]++;return this.eventHandler(event);});cov_1zzp1mzpgs.s[8]++;return this.account;}eventHandler(event){cov_1zzp1mzpgs.f[3]++;cov_1zzp1mzpgs.s[9]++;switch(event.type){case"challenge":cov_1zzp1mzpgs.b[0][0]++;cov_1zzp1mzpgs.s[10]++;this.handleChallenge(event.challenge);cov_1zzp1mzpgs.s[11]++;break;case"gameStart":cov_1zzp1mzpgs.b[0][1]++;cov_1zzp1mzpgs.s[12]++;this.handleGameStart(event.game.id);cov_1zzp1mzpgs.s[13]++;break;default:cov_1zzp1mzpgs.b[0][2]++;cov_1zzp1mzpgs.s[14]++;console.log("Unhandled event : "+JSON.stringify(event));}}handleGameStart(id){cov_1zzp1mzpgs.f[4]++;const game=(cov_1zzp1mzpgs.s[15]++,new Game(this.api,this.account.data.username,this.player));cov_1zzp1mzpgs.s[16]++;game.start(id);}async handleChallenge(challenge){cov_1zzp1mzpgs.f[5]++;cov_1zzp1mzpgs.s[17]++;if(challenge.rated){cov_1zzp1mzpgs.b[1][0]++;cov_1zzp1mzpgs.s[18]++;console.log("Declining rated challenge from "+challenge.challenger.id);const response=(cov_1zzp1mzpgs.s[19]++,await this.api.declineChallenge(challenge.id));cov_1zzp1mzpgs.s[20]++;console.log("Declined",(cov_1zzp1mzpgs.b[2][0]++,response.data)||(cov_1zzp1mzpgs.b[2][1]++,response));}else{cov_1zzp1mzpgs.b[1][1]++;cov_1zzp1mzpgs.s[21]++;console.log("Accepting unrated challenge from "+challenge.challenger.id);const response=(cov_1zzp1mzpgs.s[22]++,await this.api.acceptChallenge(challenge.id));cov_1zzp1mzpgs.s[23]++;console.log("Accepted",(cov_1zzp1mzpgs.b[3][0]++,response.data)||(cov_1zzp1mzpgs.b[3][1]++,response));}}}cov_1zzp1mzpgs.s[24]++;module.exports=RobotUser;